<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{base :: layout(~{::section})}">
<head></head>
<body>
    <section>
        <div class="row">
            <div class="col-md-4">
                <div class="card rpg-card text-white">
                    <img th:src="@{/images/avatars/hero.png}" alt="Hero" class="img-fluid rounded-circle mb-3" style="max-width: 150px; border: 2px solid #333;" onerror="this.src='https://via.placeholder.com/300?text=Hero'">
                    <div class="card-body">
                        <h3 class="card-title text-center" th:text="${player.username}">Hero</h3>
                    <div class="text-center mb-2">

                        <span class="badge rounded-pill bg-warning text-dark" style="font-size: 0.9rem; border: 1px solid #d4a017;">
                            ğŸ… <span th:text="${player.title}">åˆçº§å†’é™©è€…</span>
                        </span>
                        <div class="text-center mb-2">
                            <a href="/player/titles" class="text-decoration-none">
                                <span class="badge rounded-pill bg-warning text-dark" style="cursor: pointer;">
                                    ğŸ… <span th:text="${player.title}">åˆçº§å†’é™©è€…</span> 
                                    <small class="ms-1">(æŸ¥çœ‹å…¨éƒ¨)</small>
                                </span>
                            </a>
                        </div>
                        
                    </div>                        
                        <hr>
                        <p><strong>ğŸ”¥ åŠ›é‡ (STR):</strong> <span th:text="${player.str}">10</span></p>
                        <p><strong>ğŸ§  æ™ºåŠ› (INT):</strong> <span th:text="${player.intel}">10</span></p>
                        <div class="d-grid mt-3">
                            <a href="/player/reset" class="btn btn-outline-danger btn-sm" onclick="return confirm('è­¦å‘Šï¼šè¿™å°†é‡ç½®ä½ çš„ç­‰çº§å’Œæ‰€æœ‰å±æ€§ï¼Œç¡®å®šå—ï¼Ÿ')">ğŸ”„ åˆå§‹åŒ–å…¨éƒ¨æ•°æ®
                            </a>
                        </div>

                        <div class="d-grid mt-2">
                            <form th:action="@{/user/delete}" method="post" onsubmit="return confirm('â— æ°¸ä¹…æ³¨é”€ï¼šè¿™å°†å½»åº•åˆ é™¤ä½ çš„è´¦å·æ•°æ®ï¼Œç¡®è®¤å—ï¼Ÿ')">
                                <button type="submit" class="btn btn-outline-danger btn-sm w-100" style="opacity: 0.7;">
                                    ğŸ’€ å½»åº•æ³¨é”€è´¦å·
                                </button>
                            </form>
                        </div>

                    </div>
                </div>
            </div>

            <div class="col-md-8">
                <div class="card rpg-card text-white mb-4">
                    <div class="card-header">ç­‰çº§è¿›åº¦</div>
                    <div class="card-body">
                        <h5 class="card-title">Level <span th:text="${player.level}">1</span></h5>
                        <div class="progress" style="height: 30px; background-color: #333;">
                            <div class="progress-bar bg-info progress-bar-striped progress-bar-animated" 
                                 role="progressbar" 
                                 th:style="'width: ' + ${xpProgress} + '%'"
                                 th:text="${xpProgress} + '%'">
                            </div>
                        </div>
                        <p class="mt-2 text-white">
                            å½“å‰ç»éªŒ: <span th:text="${player.currentXp}"></span> / 
                            å‡çº§æ‰€éœ€: <span th:text="${nextLevelXp}"></span>
                        </p>
                    </div>
                </div>

                <div class="card rpg-card text-white">
                    <div class="card-header">ğŸ“Š æˆ˜æ–—åŠ›è¯„ä¼°</div>
                    <div class="card-body">
                        <div id="radarChart" style="width: 100%; height: 400px;"></div>
                    </div>
                </div>
                <script th:inline="javascript">
                    document.addEventListener('DOMContentLoaded', function() {
                        // 1. ä»åç«¯ Model è·å–çœŸå®çš„å±æ€§æ•°æ®
                        var strVal = /*[[${player.str}]]*/ 10;
                        var intVal = /*[[${player.intel}]]*/ 10;
                        var level = /*[[${player.level}]]*/ 1;
                                        
                        // 2. åˆå§‹åŒ–å›¾è¡¨
                        var chartDom = document.getElementById('radarChart');
                        var myChart = echarts.init(chartDom, 'dark'); // ä½¿ç”¨æš—è‰²ä¸»é¢˜åŒ¹é… RPG é£æ ¼
                        
                        var option = {
                            backgroundColor: 'transparent', // é€æ˜èƒŒæ™¯ï¼Œä½¿ç”¨å¡ç‰‡èƒŒæ™¯
                            radar: {
                                indicator: [
                                    { name: 'åŠ›é‡ (STR)', max: 100 },
                                    { name: 'æ™ºåŠ› (INT)', max: 100 },
                                    { name: 'æ•æ· (AGI)', max: 100 },
                                    { name: 'è€åŠ› (VIT)', max: 100 },
                                    { name: 'å¹¸è¿ (LUCK)', max: 100 },
                                    { name: 'ç­‰çº§ (LVL)', max: 50 }
                                ],
                                shape: 'circle',
                                splitNumber: 4,
                                axisName: { color: '#f0ad4e' }, // æ©™è‰²æ–‡å­—
                                splitLine: { lineStyle: { color: '#555' } },
                                splitArea: { show: false }
                            },
                            series: [{
                                name: 'Hero Status',
                                type: 'radar',
                                data: [{
                                    value: [strVal, intVal, 15, 20, 10, level], // æš‚æ—¶å¡«å…¥éƒ¨åˆ†æ¨¡æ‹Ÿå€¼
                                    name: 'å½“å‰å±æ€§',
                                    areaStyle: { color: 'rgba(240, 173, 78, 0.3)' },
                                    lineStyle: { color: '#f0ad4e', width: 2 },
                                    itemStyle: { color: '#f0ad4e' }
                                }]
                            }]
                        };
                        myChart.setOption(option);
                    });
                </script>

            </div>
        </div>
    </section>
</body>
</html>

<script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>

<div id="radarChart" style="width: 100%; height: 300px;"></div>

<script th:inline="javascript">
    // è·å–åç«¯ä¼ æ¥çš„æ•°æ®
    var str = /*[[${player.str}]]*/ 10;
    var intel = /*[[${player.intel}]]*/ 10;
    // å‡è®¾ä½ è¿˜æœ‰å…¶ä»–å±æ€§ï¼Œæˆ–è€…æš‚æ—¶ç”¨å›ºå®šå€¼æ¨¡æ‹Ÿ
    var agi = 15; 
    var luck = 5;
    var vit = 20;

    var chartDom = document.getElementById('radarChart');
    var myChart = echarts.init(chartDom);
    var option = {
        // é¼ æ ‡æç¤º
        tooltip: {
            show: true,
            trigger: 'item'
        },
        title: { text: 'èƒ½åŠ›åˆ†å¸ƒå›¾', textStyle: { color: '#fff' } },
        radar: {
            indicator: [
                { name: 'åŠ›é‡ (STR)', max: 100 },
                { name: 'æ™ºåŠ› (INT)', max: 100 },
                { name: 'æ•æ· (AGI)', max: 100 },
                { name: 'å¹¸è¿ (LUCK)', max: 100 },
                { name: 'è€åŠ› (VIT)', max: 100 }
            ]
        },
        series: [{
            name: 'Attributes',
            type: 'radar',
            data: [
                {
                    value: [str, intel, agi, luck, vit],
                    name: 'å½“å‰çŠ¶æ€'
                }
            ]
        }]
    };
    myChart.setOption(option);
</script>